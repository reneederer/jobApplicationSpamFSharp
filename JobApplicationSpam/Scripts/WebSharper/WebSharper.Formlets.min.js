(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Formlets=b.Formlets||{};d=c.Utils=c.Utils||{};e=c.CssConstants=c.CssConstants||{};f=a.StartupCode$WebSharper_Formlets$CssConstants=a.StartupCode$WebSharper_Formlets$CssConstants||{};g=c.Body=c.Body||{};h=c.ElementStore=c.ElementStore||{};i=c.Layout=c.Layout||{};j=i.Padding=i.Padding||{};k=i.LabelConfiguration=i.LabelConfiguration||{};l=i.FormRowConfiguration=i.FormRowConfiguration||{};m=c.LayoutProvider=c.LayoutProvider||{};n=c.Data=c.Data||{};o=n.Formlet=n.Formlet||{};p=n.ValidatorProvidor=n.ValidatorProvidor||{};q=c.FormletBuilder=c.FormletBuilder||{};r=c.Formlet=c.Formlet||{};s=a.StartupCode$WebSharper_Formlets$Formlet=a.StartupCode$WebSharper_Formlets$Formlet||{};t=c.Controls=c.Controls||{};u=c.Enhance=c.Enhance||{};v=u.FormButtonConfiguration=u.FormButtonConfiguration||{};w=u.ValidationIconConfiguration=u.ValidationIconConfiguration||{};x=u.ValidationFrameConfiguration=u.ValidationFrameConfiguration||{};y=u.Padding=u.Padding||{};z=u.FormContainerConfiguration=u.FormContainerConfiguration||{};A=u.ManyConfiguration=u.ManyConfiguration||{};B=b&&b.List;C=b&&b.Html;D=C&&C.Client;E=D&&D.Tags;F=a.IntelliFactory;G=F&&F.Runtime;H=b&&b.Collections;I=H&&H.Dictionary;J=b&&b.Enumerator;K=b&&b.Seq;L=D&&D.Attr;M=D&&D.Operators;N=b&&b.Util;O=F&&F.Formlets;P=O&&O.Base;Q=P&&P.Result;R=P&&P.Form;S=D&&D.Pagelet;T=P&&P.Tree;U=P&&P.FormletProvider;V=F&&F.Reactive;W=V&&V.Reactive;X=P&&P.LayoutUtils;Y=P&&P.Validator;Z=V&&V.HotStream;_0=D&&D.EventsPervasives;_1=a.Math;_2=b&&b.Arrays;_3=a.JSON;d.InTable=function(_4){var _5,_6;_5=[(_6=B.map(function(_7){var _8;_8=B.map(function(_9){return E.Tags().NewTag("td",[_9]);},_7);return E.Tags().NewTag("tr",_8);},_4),E.Tags().NewTag("tbody",_6))];return E.Tags().NewTag("table",_5);};d.MapOption=function(_4,_5){return _5!=null&&_5.$==1?{$:1,$0:_4(_5.$0)}:null;};d.Maybe=function(_4,_5,_6){return _6==null?_4:_5(_6.$0);};e.InputTextClass=function(){f.$cctor();return f.InputTextClass;};f.$cctor=function(){f.$cctor=a.ignore;f.InputTextClass="inputText";};g.New$1=function(_4,_5){return g.New(_4,_5);};g.New=function(_4,_5){return{Element:_4,Label:_5};};h=c.ElementStore=G.Class({Remove:function(_4){if(this.store.ContainsKey(_4)){(this.store.get_Item(_4))();this.store.Remove(_4);}},RegisterElement:function(_4,_5){if(!this.store.ContainsKey(_4))this.store.set_Item(_4,_5);},Init:function(){this.store=new I.New$5();}},b.Obj,h);h.NewElementStore=function(){var _4;_4=new h.New();_4.Init();return _4;};h.New=G.Ctor(function(){},h);j.get_Default=function(){return j.New(null,null,null,null);};j.New=function(_4,_5,_6,_7){return{Left:_4,Right:_5,Top:_6,Bottom:_7};};k.get_Default=function(){return k.New({$:0},{$:1},{$:0});};k.New=function(_4,_5,_6){return{Align:_4,VerticalAlign:_5,Placement:_6};};l.get_Default=function(){return l.New(null,null,null,null,null);};l.New=function(_4,_5,_6,_7,_8){return{Padding:_4,Color:_5,Class:_6,Style:_7,LabelConfiguration:_8};};m=c.LayoutProvider=G.Class({get_Horizontal:function(){return this.ColumnLayout(l.get_Default());},get_Vertical:function(){return this.RowLayout(l.get_Default());},LabelLayout:function(_4){var _5;return this.RowLayout((_5=l.get_Default(),l.New(_5.Padding,_5.Color,_5.Class,_5.Style,{$:1,$0:_4})));},get_Flowlet:function(){return this.MakeLayout(function(){var _4;function _5(_6,_7){var _8;_8=d.InTable(B.ofArray([B.ofArray([_7.Label!=null?_7.Label.$0():E.Tags().NewTag("span",[]),E.Tags().NewTag("div",[_7.Element])])]));_4.HtmlProvider.Clear(_4.get_Body());_4.AppendI(_8);return B.ofArray([_8]);}_4=E.Tags().NewTag("div",[]);return{Insert:function(_6){return function(_7){return _5(_6,_7);};},Panel:_4};});},ColumnLayout:function(_4){var _5;_5=this;return this.LayoutUtils.New(function(){var _6,_7,_8,_9;function _($,ba){var bb,bc,bd,be,bf,bg,bh,bi;bb=ba.Element.get_Id();bc=(bd=[(be=[(bf=[_5.MakeRow(_4,$,ba)],E.Tags().NewTag("tbody",bf))],E.Tags().NewTag("table",be))],E.Tags().NewTag("td",bd));bg=a.jQuery(_6.get_Body());bh=[0];bi=[false];bg.children().each(function(bj,bk){var bl;bl=a.jQuery(bk);$===bh[0]?(a.jQuery(bc.get_Body()).insertBefore(bl),bc.Render(),bi[0]=true):void 0;bh[0]++;});!bi[0]?_6.AppendI(bc):void 0;return _9.RegisterElement(bb,function(){bc.HtmlProvider.Remove(bc.get_Body());});}_6=E.Tags().NewTag("tr",[]);_7=(_8=[E.Tags().NewTag("tbody",[_6])],E.Tags().NewTag("table",_8));_9=h.NewElementStore();return{Body:g.New(_7,null),SyncRoot:null,Insert:function($){return function(ba){return _($,ba);};},Remove:function($){var ba;ba=J.Get($);try{while(ba.MoveNext())_9.Remove(ba.Current().Element.get_Id());}finally{if("Dispose"in ba)ba.Dispose();}}};});},RowLayout:function(_4){var _5;_5=this;return this.LayoutUtils.New(function(){var _6,_7,_8;function _9(_,$){var ba,bb,bc,bd,be;ba=$.Element.get_Id();bb=_5.MakeRow(_4,_,$);bc=a.jQuery(_6.get_Body());bd=[0];be=[false];bc.children().each(function(bf,bg){var bh;bh=a.jQuery(bg);_===bd[0]?(a.jQuery(bb.get_Body()).insertBefore(bh),bb.Render(),be[0]=true):void 0;bd[0]++;});!be[0]?_6.AppendI(bb):void 0;return _8.RegisterElement(ba,function(){bb.HtmlProvider.Remove(bb.get_Body());});}_6=E.Tags().NewTag("tbody",[]);_7=E.Tags().NewTag("table",[_6]);_8=h.NewElementStore();return{Body:g.New(_7,null),SyncRoot:null,Insert:function(_){return function($){return _9(_,$);};},Remove:function(_){var $;$=J.Get(_);try{while($.MoveNext())_8.Remove($.Current().Element.get_Id());}finally{if("Dispose"in $)$.Dispose();}}};});},MakeLayout:function(_4){return this.LayoutUtils.New(function(){var _5,_6;function _7(_8,_9){var _,$;_=_9.Element.get_Id();$=(_5.Insert(_8))(_9);return _6.RegisterElement(_,function(){var ba,bb;ba=J.Get($);try{while(ba.MoveNext()){bb=ba.Current();bb.HtmlProvider.Remove(bb.get_Body());}}finally{if("Dispose"in ba)ba.Dispose();}});}_5=_4();_6=h.NewElementStore();return{Body:g.New(_5.Panel,null),SyncRoot:null,Insert:function(_8){return function(_9){return _7(_8,_9);};},Remove:function(_8){var _9;_9=J.Get(_8);try{while(_9.MoveNext())_6.Remove(_9.Current().Element.get_Id());}finally{if("Dispose"in _9)_9.Dispose();}}};});},MakeRow:function(_4,_5,_6){var _7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk;function bl(bm,bn,bo,bp,bq,br,bs){var bt,bu,bv;function bw(bx,by){return bx+a.String(by)+"px;";}bt=K.reduce(function(bx,by){return bx+by;},B.map(function(bx){return bw(bx[0],bx[1]);},B.ofArray([["padding-left: ",bm],["padding-top: ",bn],["padding-right: ",bo],["padding-bottom: ",bp]])));bu=d.Maybe("",function(bx){return"vertical-align: "+(bx.$==1?"middle":bx.$==2?"bottom":"top")+";";},br);bv=B.append(new B.T({$:1,$0:L.Attr().NewAttr("style",bt+";"+bu),$1:bq?B.ofArray([L.Attr().NewAttr("colspan","2")]):B.T.Empty}),B.ofArray([bs]));return E.Tags().NewTag("td",bv);}_7=d.Maybe(j.get_Default(),a.id,_4.Padding);_8=d.Maybe(0,a.id,_7.Left);_9=d.Maybe(0,a.id,_7.Top);_=d.Maybe(0,a.id,_7.Right);$=d.Maybe(0,a.id,_7.Bottom);ba=_6.Element;bb=(bc=_6.Label,bc!=null&&bc.$==1?(bd=d.Maybe(k.get_Default(),a.id,_4.LabelConfiguration),(be=this.HorizontalAlignElem(bd.Align,bc.$0()),(bf=bd.Placement,bf.$==3?B.ofArray([bl(_8,_9,_,$,true,null,d.InTable(B.ofArray([B.ofArray([ba]),B.ofArray([be])])))]):bf.$==0?B.ofArray([bl(_8,_9,0,$,false,{$:1,$0:bd.VerticalAlign},be),bl(0,_9,_,$,false,null,ba)]):bf.$==1?B.ofArray([bl(_8,_9,0,$,false,{$:1,$0:bd.VerticalAlign},ba),bl(0,_9,_,$,false,null,be)]):B.ofArray([bl(_8,_9,_,$,true,null,d.InTable(B.ofArray([B.ofArray([be]),B.ofArray([ba])])))])))):B.ofArray([bl(_8,_9,_,$,true,null,ba)]));bg=d.Maybe(B.T.Empty,function(bm){var bn;return B.ofArray([(bn=bm(_5),L.Attr().NewAttr("class",bn))]);},_4.Class);bh=(bi=B.append(d.Maybe(B.T.Empty,function(bm){return B.ofArray(["background-color: "+bm(_5)]);},_4.Color),d.Maybe(B.T.Empty,function(bm){return B.ofArray([bm(_5)]);},_4.Style)),bi.$==0?B.T.Empty:B.ofArray([(bj=K.reduce(function(bm,bn){return bm+";"+bn;},bi),L.Attr().NewAttr("style",bj))]));bk=B.append(bg,B.append(bh,B.append(bh,bb)));return E.Tags().NewTag("tr",bk);},VerticalAlignedTD:function(_4,_5){var _6;_6=E.Tags().NewTag("td",[_5]);_6.HtmlProvider.SetCss(_6.get_Body(),"vertical-align",_4.$==1?"middle":_4.$==2?"bottom":"top");return _6;},HorizontalAlignElem:function(_4,_5){var _6;return M.add((_6=[L.Attr().NewAttr("style","float:"+(_4.$==0?"left":"right")+";")],E.Tags().NewTag("div",_6)),[_5]);}},b.Obj,m);m.New=G.Ctor(function(_4){this.LayoutUtils=_4;},m);o=n.Formlet=G.Class({Run:function(_4){var _5,_6,_7,_8,_9;_5=this.get_ElementInternal();return _5==null?(_6=this.formletBase.ApplyLayout(this),(_7=_6.BuildI(),(_7.State.Subscribe(N.observer(function(_){Q.Map(_4,_);})),_8=(_9=_6.LayoutI().Apply(_7.Body),_9==null?n.DefaultLayout().Apply(_7.Body).$0[0].Element:_9.$0[0].Element),this.set_ElementInternal({$:1,$0:_8}),_8))):_5.$0;},set_ElementInternal:function(_4){this.ElementInternal=_4;},get_ElementInternal:function(){return this.ElementInternal;},Render:function(){this.Run(a.ignore).Render();},get_Body:function(){return this.Run(a.ignore).get_Body();},MapResultI:function(_4){var _5;_5=this;return new o.New(function(){var _6;_6=_5.buildInternal();return R.New(_6.Body,_6.Dispose$1,_6.Notify,_5.utils.Reactive.Select(_6.State,_4));},this.layoutInternal,this.formletBase,this.utils);},LayoutI:function(){return this.layoutInternal;},BuildI:function(){return this.buildInternal();}},D.Pagelet,o);o.New=G.Ctor(function(_4,_5,_6,_7){S.New.call(this);this.buildInternal=_4;this.layoutInternal=_5;this.formletBase=_6;this.utils=_7;this.ElementInternal=null;},o);p=n.ValidatorProvidor=G.Class({Matches:function(_4,_5){return _5.match(new a.RegExp(_4));}},b.Obj,p);p.New=G.Ctor(function(){},p);n.$=function(_4,_5){return n.OfIFormlet(n.BaseFormlet().Apply(_4,_5));};n.Validator=function(){s.$cctor();return s.Validator;};n.MkFormlet=function(_4){return n.OfIFormlet(n.BaseFormlet().New(function(){var _5,_6,_7;_5=_4();_6=_5[1];return R.New((_7=T.Set(n.NewBody(_5[0],null)),n.RX().Return(_7)),a.ignore,function(){_6();},_5[2]);}));};n.OfIFormlet=function(_4){return n.PropagateRenderFrom(_4,new o.New(function(){return _4.BuildI();},_4.LayoutI(),n.BaseFormlet(),n.UtilsProvider()));};n.PropagateRenderFrom=function(_4,_5){_4.hasOwnProperty("Render")?_5.Render=_4.Render:void 0;return _5;};n.BaseFormlet=function(){return new U.New(n.UtilsProvider());};n.UtilsProvider=function(){return{Reactive:n.RX(),DefaultLayout:n.DefaultLayout()};};n.DefaultLayout=function(){s.$cctor();return s.DefaultLayout;};n.set_DefaultLayout=function(_4){s.$cctor();s.DefaultLayout=_4;};n.Layout=function(){s.$cctor();return s.Layout;};n.RX=function(){s.$cctor();return s.RX;};n.NewBody=function(_4,_5){return g.New$1(_4,_5);};q=c.FormletBuilder=G.Class({ReturnFrom:function(_4){return n.OfIFormlet(_4);},Delay:function(_4){return n.OfIFormlet(n.BaseFormlet().Delay(_4));},Bind:function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().Bind(_4,_5)));},Return:function(_4){return n.OfIFormlet(n.BaseFormlet().Return(_4));}},b.Obj,q);q.New=G.Ctor(function(){},q);r.Choose=function(_4){var _5,_6;_5=[0];return r.Map(function(_7){return _7.$0;},(_6=r.Map(function(_7){function _8(_,$){return{$:1,$0:_};}function _9(_,$){return $;}return K.tryPick(function(_){return _8(_[0],_[1]);},B.rev(B.sortBy(function(_){return _9(_[0],_[1]);},B.choose(function(_){return _.$==0?{$:1,$0:_.$0}:null;},_7))));},r.Sequence(K.map(function(_7){return r.LiftResult(r.InitWithFailure(r.Map(function(_8){_5[0]++;return[_8,_5[0]];},_7)));},_4))),n.Validator().Is(function(_7){return _7!=null;},"",_6)));};r.Render=function(_4){return n.PropagateRenderFrom(_4,_4.Run(a.ignore));};r.BindWith=function(_4,_5,_6){return n.OfIFormlet(n.PropagateRenderFrom(_5,n.BaseFormlet().BindWith(_4,_5,_6)));};r.Run=function(_4,_5){return _5.Run(_4);};r.WithLabel=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_5,n.BaseFormlet().MapBody(function(_6){return g.New(_6.Element,_4);},_5)));};r.OfElement=function(_4){return n.MkFormlet(function(){return[_4(),a.ignore,n.RX().Return({$:0,$0:null})];});};r.MapElement=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_5,n.BaseFormlet().MapBody(function(_6){return g.New(_4(_6.Element),_6.Label);},_5)));};r.ApplyLayout=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().ApplyLayout(_4)));};r.WithNotificationChannel=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().WithNotificationChannel(_4)));};r.WithNotification=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_5,n.BaseFormlet().WithNotification(_4,_5)));};r.WithLayout=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_5,n.BaseFormlet().WithLayout(_4,_5)));};r.Sequence=function(_4){return n.OfIFormlet(n.BaseFormlet().Sequence(K.map(a.id,_4)));};r.LiftResult=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().LiftResult(_4)));};r.SelectMany=function(_4){var _5;return n.OfIFormlet(n.PropagateRenderFrom(_4,(_5=r.Map(a.id,_4),n.BaseFormlet().SelectMany(_5))));};r.FlipBody=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().FlipBody(_4)));};r.Switch=function(_4){var _5;return n.OfIFormlet(n.PropagateRenderFrom(_4,(_5=r.Map(a.id,_4),n.BaseFormlet().Switch(_5))));};r.Join=function(_4){var _5;return n.OfIFormlet(n.PropagateRenderFrom(_4,(_5=r.Map(a.id,_4),n.BaseFormlet().Join(_5))));};r.Replace=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().Replace(_4,_5)));};r.Bind=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().Bind(_4,_5)));};r.Delay=function(_4){return n.OfIFormlet(n.BaseFormlet().Delay(_4));};r.MapResult=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_5,n.BaseFormlet().MapResult(_4,_5)));};r.MapBody=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_5,n.BaseFormlet().MapBody(_4,_5)));};r.Map=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_5,n.BaseFormlet().Map(_4,_5)));};r.Do=function(){s.$cctor();return s.Do;};r.FailWith=function(_4){return n.OfIFormlet(n.BaseFormlet().FailWith(_4));};r.Deletable=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().Deletable(_4)));};r.BuildForm=function(_4){return n.BaseFormlet().BuildForm(_4);};r.ReturnEmpty=function(_4){return n.OfIFormlet(n.BaseFormlet().ReturnEmpty(_4));};r.Empty=function(){return n.OfIFormlet(n.BaseFormlet().Empty());};r.Never=function(){return n.OfIFormlet(n.BaseFormlet().Never());};r.ReplaceFirstWithFailure=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().ReplaceFirstWithFailure(_4)));};r.Flowlet=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().WithLayout(n.Layout().get_Flowlet(),_4)));};r.Vertical=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().WithLayout(n.Layout().get_Vertical(),_4)));};r.Horizontal=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().WithLayout(n.Layout().get_Horizontal(),_4)));};r.InitWithFailure=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().InitWithFailure(_4)));};r.InitWith=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_5,n.BaseFormlet().InitWith(_4,_5)));};r.WithCancelation=function(_4,_5){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().WithCancelation(_4,_5)));};r.Return=function(_4){return n.OfIFormlet(n.BaseFormlet().Return(_4));};r.WithLayoutOrDefault=function(_4){return n.OfIFormlet(n.PropagateRenderFrom(_4,n.BaseFormlet().WithLayoutOrDefault(_4)));};r.New=function(_4){return n.OfIFormlet(n.BaseFormlet().New(_4));};r.BuildFormlet=function(_4){return n.MkFormlet(_4);};s.$cctor=function(){s.$cctor=a.ignore;s.RX=W.Default();s.Layout=new m.New(new X.New({Reactive:W.Default()}));s.DefaultLayout=n.Layout().get_Vertical();s.Validator=new Y.New(new p.New());s.Do=new q.New();};t.Button=function(_4){return t.ElementButton(function(){var _5;_5=[E.Tags().text(_4)];return E.Tags().NewTag("button",_5);});};t.ElementButton=function(_4){return n.MkFormlet(function(){var _5,_6,_7;function _8(_9,_){_5.Trigger({$:0,$0:_6[0]});_6[0]++;}_5=Z.New$1({$:1,$0:B.T.Empty});_6=[0];return[(_7=_4(),(function(_9){_0.Events().OnClick(function(_){return function($){return _8(_,$);};},_9);}(_7),_7)),function(){_6[0]=0;_5.Trigger({$:1,$0:B.T.Empty});},_5];});};t.ReadOnlyInput=function(_4){return t.InputField(true,"text",e.InputTextClass(),_4);};t.Input=function(_4){return t.InputField(false,"text",e.InputTextClass(),_4);};t.Password=function(_4){return t.InputField(false,"password","inputPassword",_4);};t.ReadOnlyRadioButtonGroup=function(_4,_5){return t.RadioButtonGroupControl(true,_4,_5);};t.RadioButtonGroup=function(_4,_5){return t.RadioButtonGroupControl(false,_4,_5);};t.RadioButtonGroupControl=function(_4,_5,_6){return r.New(function(){var _7,_8,_9,_,$;function ba(be,bf){return _5==null?null:_5.$0===be?{$:1,$0:{$:0,$0:bf}}:null;}function bb(be,bf){var bg;return[M.add((bg=[L.Attr().NewAttr("class","inputRadio"),L.Attr().NewAttr("type","radio"),L.Attr().NewAttr("name",_7)],E.Tags().NewTag("input",bg)),_4?B.ofArray([L.Attr().NewAttr("disabled","disabled")]):B.T.Empty),be,bf];}function bc(be,bf,bg){return _5==null?(be.HtmlProvider.RemoveAttribute(be.get_Body(),"checked"),_8.Trigger({$:1,$0:B.T.Empty})):_5.$0===bg?(be.HtmlProvider.SetProperty(be.get_Body(),"checked",true),_8.Trigger({$:0,$0:bf})):be.HtmlProvider.SetProperty(be.get_Body(),"checked",false);}function bd(){B.iteri(function(be,bf){return bc(bf[0],bf[2],be);},_);}_7="id"+_1.round(_1.random()*100000000);_8=(_9=_5==null?null:K.tryPick(function(be){return ba(be[0],be[1]);},B.mapi(function(be,bf){return[be,bf[1]];},_6)),d.Maybe(Z.New$1({$:1,$0:B.T.Empty}),Z.New$1,_9));_=B.map(function(be){return bb(be[0],be[1]);},_6);return R.New(($=new T.Edit({$:0,$0:T.FromSequence(B.mapi(function(be,bf){var bg,bh,bi;function bj(bk,bl){return!_4?_8.Trigger({$:0,$0:bi}):null;}bg=bf[0];bh=bf[1];bi=bf[2];bc(bg,bi,be);_0.Events().OnClick(function(bk){return function(bl){return bj(bk,bl);};},bg);return g.New(bg,{$:1,$0:function(){var bk;bk=[E.Tags().text(bh)];return E.Tags().NewTag("label",bk);}});},_))}),n.RX().Return($)),a.ignore,function(){bd();},_8);});};t.CheckboxGroup=function(_4){return t.CheckboxGroupControl(false,_4);};t.CheckboxGroupControl=function(_4,_5){function _6(_8,_9){return _8?{$:1,$0:_9}:null;}function _7(_8,_9,_){return r.Map(function($){return[$,_9];},r.WithLabel({$:1,$0:function(){var $;$=[E.Tags().text(_8)];return E.Tags().NewTag("label",$);}},t.CheckboxControl(_4,_)));}return r.Map(function(_8){return B.choose(function(_9){return _6(_9[0],_9[1]);},_8);},r.Sequence(B.map(function(_8){return _7(_8[0],_8[1],_8[2]);},_5)));};t.ReadOnlyCheckbox=function(_4){return t.CheckboxControl(true,_4);};t.Checkbox=function(_4){return t.CheckboxControl(false,_4);};t.CheckboxControl=function(_4,_5){return n.MkFormlet(function(){var _6,_7,_8,_9,_;function $(bb,bc){return!_4?_6.Trigger({$:0,$0:a.jQuery(bb.get_Body()).prop("checked")}):null;}function ba(){_5?_7.HtmlProvider.SetProperty(_7.get_Body(),"checked",true):(_7.HtmlProvider.RemoveAttribute(_7.get_Body(),"checked"),_7.HtmlProvider.SetProperty(_7.get_Body(),"checked",false));_6.Trigger({$:0,$0:_5});}_6=Z.New$1({$:0,$0:_5});_7=(_8=_4?B.ofArray([L.Attr().NewAttr("disabled","disabled")]):B.T.Empty,(_9=M.add((_=[L.Attr().NewAttr("type","checkbox"),L.Attr().NewAttr("class","inputCheckbox")],E.Tags().NewTag("input",_)),_8),(function(bb){_0.Events().OnClick(function(bc){return function(bd){return $(bc,bd);};},bb);}(_9),_9)));_5?_7.HtmlProvider.SetAttribute(_7.get_Body(),"defaultChecked","true"):_7.HtmlProvider.RemoveAttribute(_7.get_Body(),"checked");ba();return[_7,ba,_6];});};t.InputField=function(_4,_5,_6,_7){return t.InputControl(_7,function(_8){var _9,_,$;function ba(){if(!_4)_8.Trigger({$:0,$0:_9.get_Value()});}_9=(_=_4?B.ofArray([L.Attr().NewAttr("readonly","readonly")]):B.T.Empty,($=B.append(B.ofArray([L.Attr().NewAttr("type",_5),L.Attr().NewAttr("class",_6)]),_),E.Tags().NewTag("input",$)));(function(bb){t.OnTextChange(ba,bb);}(_9));return _9;});};t.ReadOnlyTextArea=function(_4){return t.TextAreaControl(true,_4);};t.TextArea=function(_4){return t.TextAreaControl(false,_4);};t.TextAreaControl=function(_4,_5){return t.InputControl(_5,function(_6){var _7,_8;function _9(){if(!_4)_6.Trigger({$:0,$0:_7.get_Value()});}_7=(_8=_4?B.ofArray([L.Attr().NewAttr("readonly","readonly")]):B.T.Empty,E.Tags().NewTag("textarea",_8));(function(_){t.OnTextChange(_9,_);}(_7));return _7;});};t.OnTextChange=function(_4,_5){var _6;function _7(){if(_5.get_Value()!==_6[0]){_6[0]=_5.get_Value();_4();}}function _8($){_7();}function _9($,ba){return _8($);}function _($,ba){return _7();}_6=[_5.get_Value()];_0.Events().OnChange(function($){return function(ba){return _9($,ba);};},_5);_0.Events().OnKeyUp(function($){return function(ba){return _($,ba);};},_5);_5.Dom.oninput=_7;};t.InputControl=function(_4,_5){return n.MkFormlet(function(){var _6,_7;_6=Z.New$1({$:0,$0:_4});_7=_5(_6);_7.set_Value(_4);return[_7,function(){_7.set_Value(_4);_6.Trigger({$:0,$0:_4});},_6];});};t.ReadOnlySelect=function(_4,_5){return t.SelectControl(true,_4,_5);};t.Select=function(_4,_5){return t.SelectControl(false,_4,_5);};t.SelectControl=function(_4,_5,_6){return n.MkFormlet(function(){var _7,_8,_9,_,$,ba;function bb(){_9.HtmlProvider.SetProperty(_9.get_Body(),"value",a.String(_8));ba.Trigger($);}function bc(be){if(!_4)ba.Trigger({$:0,$0:_2.get(_7,a.Number(_9.get_Value()))});}function bd(be,bf){return bc(be);}_7=_2.ofList(B.map(function(be){return be[1];},_6));_8=_5>=0&&_5<_6.get_Length()?_5:0;_9=_4?M.add((_=B.mapi(function(be,bf){return E.Tags().NewTag("option",[E.Tags().text(bf[0]),L.Attr().NewAttr("value",a.String(be))]);},_6),E.Tags().NewTag("select",_)),[L.Attr().NewAttr("disabled","disabled")]):(_=B.mapi(function(be,bf){return E.Tags().NewTag("option",[E.Tags().text(bf[0]),L.Attr().NewAttr("value",a.String(be))]);},_6),E.Tags().NewTag("select",_));$={$:0,$0:_2.get(_7,_8)};ba=Z.New$1($);bb();_0.Events().OnChange(function(be){return function(bf){return bd(be,bf);};},_9);bb();return[_9,bb,ba];});};v.get_Default=function(){return v.New(null,null,null);};v.New=function(_4,_5,_6){return{Label:_4,Style:_5,Class:_6};};w.get_Default=function(){return w.New("validIcon","errorIcon");};w.New=function(_4,_5){return{ValidIconClass:_4,ErrorIconClass:_5};};x.get_Default=function(){return x.New({$:1,$0:"successFormlet"},null,{$:1,$0:"errorFormlet"},null);};x.New=function(_4,_5,_6,_7){return{ValidClass:_4,ValidStyle:_5,ErrorClass:_6,ErrorStyle:_7};};y.get_Default=function(){return y.New(null,null,null,null);};y.New=function(_4,_5,_6,_7){return{Left:_4,Right:_5,Top:_6,Bottom:_7};};z.get_Default=function(){return z.New(null,y.get_Default(),null,null,null,null,null);};z.New=function(_4,_5,_6,_7,_8,_9,_){return{Header:_4,Padding:_5,Description:_6,BackgroundColor:_7,BorderColor:_8,CssClass:_9,Style:_};};A.get_Default=function(){return A.New("addIcon","removeIcon");};A.New=function(_4,_5){return{AddIconClass:_4,RemoveIconClass:_5};};u.WithJsonPost=function(_4,_5){var _6,_7,_8,_9,_,$,ba,bb,bc;function bd(be){var bf;bf=_4.EncodingType;bf==null?void 0:bf.$0==="multipart/form-data"?a.jQuery(be.get_Body()).attr("encoding","multipart/form-data"):void 0;}_6=(_7=_4.PostUrl,_7==null?B.T.Empty:B.ofArray([L.Attr().NewAttr("action",_7.$0)]));_8=(_9=_4.EncodingType,_9==null?B.T.Empty:B.ofArray([L.Attr().NewAttr("enctype",_9.$0)]));_=E.Tags().NewTag("input",[L.Attr().NewAttr("type","hidden"),L.Attr().NewAttr("name",_4.ParameterName)]);$=E.Tags().NewTag("input",[L.Attr().NewAttr("type","submit"),L.Attr().NewAttr("value","Submit")]);ba=[(bb=M.add((bc=B.append(new B.T({$:1,$0:L.Attr().NewAttr("method","POST"),$1:new B.T({$:1,$0:L.Attr().NewAttr("style","display:none"),$1:_6})}),_8),E.Tags().NewTag("form",bc)),[_,$]),(function(be){M.OnAfterRender(bd,be);}(bb),bb)),r.Map(function(be){var bf;bf=_3.stringify(be);a.jQuery(_.get_Body()).val(bf);return a.jQuery($.get_Body()).click();},_5)];return E.Tags().NewTag("div",ba);};u.Many=function(_4){return u.CustomMany(A.get_Default(),_4);};u.CustomMany=function(_4,_5){var _6,_7,_8,_9,_,$;function ba(){return r.ApplyLayout(r.WithLayoutOrDefault(r.Map(B.ofSeq,u.Many_(_6,function(){return _7;}))));}_6=r.InitWith(1,t.ElementButton(function(){var bb;return M.add((bb=[L.Attr().NewAttr("class",_4.AddIconClass)],E.Tags().NewTag("div",bb)),[E.Tags().NewTag("div",[])]);}));_7=u.Deletable((_8=r.WithCancelation(_5,r.Map(a.ignore,t.ElementButton(function(){var bb;return M.add((bb=[L.Attr().NewAttr("class",_4.RemoveIconClass)],E.Tags().NewTag("div",bb)),[E.Tags().NewTag("div",[])]);}))),r.WithLayout(n.Layout().get_Horizontal(),_8)));_9=Z.New$1({$:0,$0:null});_=n.OfIFormlet(n.BaseFormlet().FromState(_9));return r.WithNotification(function(){_9.Trigger({$:0,$0:null});},($=r.Do(),$.Delay(function(){return $.Bind(_,function(){return $.ReturnFrom(ba());});})));};u.Many_=function(_4,_5){return r.Map(function(_6){return K.choose(a.id,_6);},r.FlipBody(r.SelectMany(r.Map(_5,_4))));};u.Deletable=function(_4){return u.Replace(_4,function(_5){return _5!=null&&_5.$==1?r.Return({$:1,$0:_5.$0}):r.ReturnEmpty(null);});};u.Replace=function(_4,_5){return r.Switch(r.MapResult(function(_6){return _6.$==1?{$:0,$0:r.FailWith(_6.$0)}:{$:0,$0:_5(_6.$0)};},_4));};u.Cancel=function(_4,_5){return r.Replace(_4,function(_6){return _5(_6)?r.Empty():r.Return(_6);});};u.WithRowConfiguration=function(_4,_5){var _6;_6=r.ApplyLayout(_5);return r.WithLayout(n.Layout().RowLayout(_4),_6);};u.WithLegend=function(_4,_5){return r.MapBody(function(_6){var _7,_8,_9;return g.New((_7=[(_8=[E.Tags().text(_4)],E.Tags().NewTag("legend",_8)),(_9=_6.Label,_9==null?_6.Element:d.InTable(B.ofArray([B.ofArray([_9.$0(),_6.Element])])))],E.Tags().NewTag("fieldset",_7)),null);},_5);};u.WithCssClass=function(_4,_5){return r.MapElement(function(_6){_6.HtmlProvider.AddClass(_6.get_Body(),_4);return _6;},_5);};u.WithFormContainer=function(_4){return u.WithCustomFormContainer(z.get_Default(),_4);};u.WithCustomFormContainer=function(_4,_5){return r.MapElement(function(_6){var _7,_8,_9,_,$,ba,bb,bc,bd;function be(bf,bg){if(bg==null);else _.HtmlProvider.SetCss(_.get_Body(),bf,bg.$0);}_7=d.Maybe(B.T.Empty,function(bf){var bg;return bf.$==1?B.ofArray([bf.$0()]):B.ofArray([(bg=[E.Tags().text(bf.$0)],E.Tags().NewTag("p",bg))]);},_4.Description);_8=d.Maybe(d.InTable(B.ofArray([B.ofArray([M.add((_9=[L.Attr().NewAttr("class","headerPanel")],E.Tags().NewTag("div",_9)),_7)]),B.ofArray([_6])])),function(bf){var bg,bh,bi;return d.InTable(B.ofArray([B.ofArray([(bg=bf.$==1?bf.$0():(bh=[E.Tags().text(bf.$0)],E.Tags().NewTag("h1",bh)),M.add((bi=[L.Attr().NewAttr("class","headerPanel")],E.Tags().NewTag("div",bi)),new B.T({$:1,$0:bg,$1:_7})))]),B.ofArray([_6])]));},_4.Header);_=M.add(($=[L.Attr().NewAttr("class","formlet")],E.Tags().NewTag("td",$)),[_8]);d.Maybe(null,function(bf){_.HtmlProvider.SetStyle(_.get_Body(),"border-color: "+bf);},_4.BorderColor);B.iter(function(bf){return be(bf[0],bf[1]);},B.ofArray([["background-color",d.MapOption(a.id,_4.BackgroundColor)],["padding-left",d.MapOption(function(bf){return a.String(bf)+"px";},_4.Padding.Left)],["padding-right",d.MapOption(function(bf){return a.String(bf)+"px";},_4.Padding.Right)],["padding-top",d.MapOption(function(bf){return a.String(bf)+"px";},_4.Padding.Top)],["padding-bottom",d.MapOption(function(bf){return a.String(bf)+"px";},_4.Padding.Bottom)]]));ba=_4.Style;ba==null?void 0:_.HtmlProvider.SetStyle(_.get_Body(),ba.$0);bb=_4.CssClass;bb==null?void 0:_.HtmlProvider.AddClass(_.get_Body(),bb.$0);bc=[(bd=[E.Tags().NewTag("tr",[_])],E.Tags().NewTag("tbody",bd))];return E.Tags().NewTag("table",bc);},r.ApplyLayout(_5));};u.WithLabelLeft=function(_4){return r.MapBody(function(_5){var _6,_7,_8,_9,_;return g.New((_6=(_7=_5.Label,_7==null?E.Tags().NewTag("span",[]):_7.$0()),(_8=[(_9=[(_=[E.Tags().NewTag("td",[_5.Element]),E.Tags().NewTag("td",[_6])],E.Tags().NewTag("tr",_))],E.Tags().NewTag("tbody",_9))],E.Tags().NewTag("table",_8))),null);},_4);};u.WithLabelAbove=function(_4){return r.MapBody(function(_5){var _6,_7,_8,_9,_,$;return g.New((_6=[(_7=[(_8=[(_9=[(_=_5.Label,_==null?E.Tags().NewTag("span",[]):_.$0())],E.Tags().NewTag("td",_9))],E.Tags().NewTag("tr",_8)),($=[E.Tags().NewTag("td",[_5.Element])],E.Tags().NewTag("tr",$))],E.Tags().NewTag("tbody",_7))],E.Tags().NewTag("table",_6)),null);},_4);};u.WithTextLabel=function(_4,_5){return u.WithLabel(function(){var _6;_6=[E.Tags().text(_4)];return E.Tags().NewTag("label",_6);},_5);};u.WithLabelAndInfo=function(_4,_5,_6){return u.WithLabel(function(){var _7,_8;return d.InTable(B.ofArray([B.ofArray([(_7=[E.Tags().text(_4)],E.Tags().NewTag("label",_7)),(_8=[L.Attr().NewAttr("title",_5),L.Attr().NewAttr("class","infoIcon")],E.Tags().NewTag("span",_8))])]));},_6);};u.WithLabelConfiguration=function(_4,_5){var _6;_6=r.ApplyLayout(_5);return r.WithLayout(n.Layout().LabelLayout(_4),_6);};u.WithLabel=function(_4,_5){return r.WithLabel({$:1,$0:_4},_5);};u.WithErrorFormlet=function(_4,_5){var _6;return r.MapResult(Q.Join,(_6=r.Do(),_6.Delay(function(){return _6.Bind(r.LiftResult(_5),function(_7){var _8,_9;return _6.ReturnFrom(_7.$==1?(_8=_7.$0,(_9=r.Do(),_9.Delay(function(){return _9.Bind(_4(_8),function(){return _9.Return(_7);});}))):r.Return(_7));});})));};u.WithValidationFrame=function(_4){return u.WithCustomValidationFrame(x.get_Default(),_4);};u.WithErrorSummary=function(_4,_5){var _6;function _7(_8){return r.OfElement(function(){var _9,_,$;_9=[(_=[E.Tags().text(_4)],E.Tags().NewTag("legend",_)),($=B.map(function(ba){var bb;bb=[E.Tags().text(ba)];return E.Tags().NewTag("li",bb);},_8),E.Tags().NewTag("ul",$))];return E.Tags().NewTag("fieldset",_9);});}return r.MapResult(Q.Join,(_6=r.Do(),_6.Delay(function(){return _6.Bind(r.LiftResult(_5),function(_8){return _6.ReturnFrom(_8.$==1?r.Map(function(){return _8;},_7(_8.$0)):r.Return(_8));});})));};u.WithSubmitButton=function(_4){return u.WithCustomSubmitButton(v.get_Default(),_4);};u.WithCustomSubmitButton=function(_4,_5){var _6;_6=_4.Label==null?v.New({$:1,$0:"Submit"},_4.Style,_4.Class):_4;return u.WithSubmitFormlet(_5,function(_7){return r.Map(a.ignore,u.InputButton(_6,_7.$==0&&true));});};u.WithResetButton=function(_4){return u.WithCustomResetButton(v.get_Default(),_4);};u.WithCustomResetButton=function(_4,_5){return u.WithResetFormlet(_5,u.InputButton(_4.Label==null?v.New({$:1,$0:"Reset"},_4.Style,_4.Class):_4,true));};u.WithCustomValidationFrame=function(_4,_5){return u.WrapFormlet(function(_6,_7){var _8;function _9(_){_6.Subscribe(N.observer(function($){var ba,bb,bc,bd,be,bf;if($.$==1){ba=_4.ValidClass;ba!=null&&ba.$==1?_.HtmlProvider.RemoveClass(_.get_Body(),ba.$0):void 0;bb=_4.ErrorClass;bb!=null&&bb.$==1?_.HtmlProvider.AddClass(_.get_Body(),bb.$0):void 0;bc=_4.ErrorStyle;bc!=null&&bc.$==1?_.HtmlProvider.SetStyle(_.get_Body(),bc.$0):_.HtmlProvider.SetStyle(_.get_Body(),"");}else{bd=_4.ErrorClass;bd!=null&&bd.$==1?_.HtmlProvider.RemoveClass(_.get_Body(),bd.$0):void 0;be=_4.ValidClass;be!=null&&be.$==1?_.HtmlProvider.AddClass(_.get_Body(),be.$0):void 0;bf=_4.ValidStyle;bf!=null&&bf.$==1?_.HtmlProvider.SetStyle(_.get_Body(),bf.$0):_.HtmlProvider.SetStyle(_.get_Body(),"");}}));}_8=E.Tags().NewTag("div",[_7.Element]);(function(_){M.OnAfterRender(_9,_);}(_8));return _8;},_5);};u.WrapFormlet=function(_4,_5){return n.MkFormlet(function(){var _6,_7;_6=r.WithLayoutOrDefault(_5);_7=r.BuildForm(_6);return[_4(_7.State,_6.LayoutI().Apply(_7.Body).$0[0]),function(){_7.Notify(null);},_7.State];});};u.WithValidationIcon=function(_4){return u.WithCustomValidationIcon(w.get_Default(),_4);};u.WithCustomValidationIcon=function(_4,_5){var _6,_7,_8;function _9(_){return r.OfElement(function(){var $,ba,bb;return _.$==1?($=K.fold(function(bc,bd){return bc+" "+bd;},"",_.$0),M.add((ba=[L.Attr().NewAttr("class",_4.ErrorIconClass),L.Attr().NewAttr("title",$)],E.Tags().NewTag("div",ba)),[E.Tags().NewTag("div",[])])):M.add((bb=[L.Attr().NewAttr("class",_4.ValidIconClass),L.Attr().NewAttr("title","")],E.Tags().NewTag("div",bb)),[E.Tags().NewTag("div",[])]);});}_6=r.WithLayoutOrDefault(_5);_7=r.MapResult(Q.Join,(_8=r.Do(),_8.Delay(function(){return _8.Bind(r.LiftResult(_6),function(_){return _8.Bind(_9(_),function(){return _8.Return(_);});});})));return r.WithLayout(n.Layout().get_Horizontal(),_7);};u.WithSubmitAndResetButtons=function(_4){var _5,_6;return u.WithCustomSubmitAndResetButtons((_5=v.get_Default(),v.New({$:1,$0:"Submit"},_5.Style,_5.Class)),(_6=v.get_Default(),v.New({$:1,$0:"Reset"},_6.Style,_6.Class)),_4);};u.WithCustomSubmitAndResetButtons=function(_4,_5,_6){return u.WithSubmitAndReset(_6,function(_7,_8){var _9,_,$,ba,bb,bc;_9=_8.$==1?(_=_8.$0,r.MapResult(function(){return{$:1,$0:_};},u.InputButton(_4,false))):($=_8.$0,r.Map(function(){return $;},u.InputButton(_4,true)));ba=(bb=r.Do(),bb.Delay(function(){return bb.Bind(r.LiftResult(u.InputButton(_5,true)),function(bd){bd.$==0?_7():void 0;return bb.Return();});}));bc=n.$(n.$(r.Return(function(bd){return function(){return bd;};}),_9),ba);return r.WithLayout(n.Layout().get_Horizontal(),bc);});};u.InputButton=function(_4,_5){return n.MkFormlet(function(){var _6,_7,_8,_9,_,$,ba,bb,bc;function bd(be,bf){_7[0]++;return _6.Trigger({$:0,$0:_7[0]});}_6=Z.New$1({$:1,$0:B.T.Empty});_7=[0];_8=(_9=d.Maybe("Submit",a.id,_4.Label),(_=($=M.add((ba=[L.Attr().NewAttr("type","button")],E.Tags().NewTag("input",ba)),[L.Attr().NewAttr("class","submitButton"),L.Attr().NewAttr("value",_9)]),(function(be){_0.Events().OnClick(function(bf){return function(bg){return bd(bf,bg);};},be);}($),$)),(!_5?_.HtmlProvider.AddClass(_.get_Body(),"disabledButton"):void 0,bb=_4.Style,bb!=null&&bb.$==1?_.HtmlProvider.SetStyle(_.get_Body(),bb.$0):void 0,bc=_4.Class,bc!=null&&bc.$==1?_.HtmlProvider.AddClass(_.get_Body(),bc.$0):void 0,_)));_6.Trigger({$:1,$0:B.T.Empty});return[_8,function(){_7[0]=0;_6.Trigger({$:1,$0:B.T.Empty});},_6];});};u.WithSubmitAndReset=function(_4,_5){var _6;return n.OfIFormlet(n.PropagateRenderFrom(_4,(_6=r.Do(),_6.Delay(function(){return _6.Bind(r.WithNotificationChannel(r.LiftResult(r.InitWithFailure(_4))),function(_7){var _8;_8=_7[1];return _6.ReturnFrom(_5(function(){_8(void 0);},_7[0]));});}))));};u.WithSubmitFormlet=function(_4,_5){var _6;return n.OfIFormlet(n.PropagateRenderFrom(_4,r.MapResult(Q.Join,(_6=r.Do(),_6.Delay(function(){return _6.Bind(r.LiftResult(r.InitWithFailure(_4)),function(_7){return _6.Bind(_5(_7),function(){return _6.Return(_7);});});})))));};u.WithResetAction=function(_4,_5){var _6;return n.OfIFormlet(n.PropagateRenderFrom(_5,(_6=r.New(function(){var _7;_7=_5.BuildI();return R.New(_7.Body,_7.Dispose$1,function(_8){if(_4())_7.Notify(_8);},_7.State);}),r.WithLayout(_5.LayoutI(),_6))));};u.WithResetFormlet=function(_4,_5){var _6,_7,_8;_6=r.WithNotificationChannel(r.LiftResult(r.InitWithFailure(r.ApplyLayout(r.WithLayoutOrDefault(_4)))));_7=r.LiftResult(_5);return n.OfIFormlet(n.PropagateRenderFrom(_6,r.MapResult(Q.Join,(_8=r.Do(),_8.Delay(function(){return _8.Bind(_6,function(_9){var _,$;_=_9[0];$=_9[1];return _8.Bind(_7,function(ba){ba.$==0?$(void 0):void 0;return _8.Return(_);});});})))));};}());
