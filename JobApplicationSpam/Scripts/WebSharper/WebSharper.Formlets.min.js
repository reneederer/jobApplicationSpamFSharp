(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4;a=window;b=a.WebSharper=a.WebSharper||{};c=b.Formlets=b.Formlets||{};d=c.Utils=c.Utils||{};e=c.CssConstants=c.CssConstants||{};f=a.StartupCode$WebSharper_Formlets$CssConstants=a.StartupCode$WebSharper_Formlets$CssConstants||{};g=c.Body=c.Body||{};h=b&&b.Obj;i=c.ElementStore=c.ElementStore||{};j=c.Layout=c.Layout||{};k=j.Padding=j.Padding||{};l=j.LabelConfiguration=j.LabelConfiguration||{};m=j.FormRowConfiguration=j.FormRowConfiguration||{};n=c.LayoutProvider=c.LayoutProvider||{};o=b&&b.Html;p=o&&o.Client;q=p&&p.Pagelet;r=c.Data=c.Data||{};s=r.Formlet=r.Formlet||{};t=r.ValidatorProvidor=r.ValidatorProvidor||{};u=c.FormletBuilder=c.FormletBuilder||{};v=c.Formlet=c.Formlet||{};w=a.StartupCode$WebSharper_Formlets$Formlet=a.StartupCode$WebSharper_Formlets$Formlet||{};x=c.Controls=c.Controls||{};y=c.Enhance=c.Enhance||{};z=y.FormButtonConfiguration=y.FormButtonConfiguration||{};A=y.ValidationIconConfiguration=y.ValidationIconConfiguration||{};B=y.ValidationFrameConfiguration=y.ValidationFrameConfiguration||{};C=y.Padding=y.Padding||{};D=y.FormContainerConfiguration=y.FormContainerConfiguration||{};E=y.ManyConfiguration=y.ManyConfiguration||{};F=b&&b.List;G=p&&p.Tags;H=a.IntelliFactory;I=H&&H.Runtime;J=b&&b.Collections;K=J&&J.Dictionary;L=b&&b.Enumerator;M=b&&b.Seq;N=p&&p.Attr;O=p&&p.Operators;P=b&&b.Util;Q=H&&H.Formlets;R=Q&&Q.Base;S=R&&R.Result;T=R&&R.Form;U=R&&R.Tree;V=R&&R.FormletProvider;W=H&&H.Reactive;X=W&&W.Reactive;Y=R&&R.LayoutUtils;Z=R&&R.Validator;_0=W&&W.HotStream;_1=p&&p.EventsPervasives;_2=a.Math;_3=b&&b.Arrays;_4=a.JSON;d.InTable=function(_5){var _6,_7;_6=[(_7=F.map(function(_8){var _9;_9=F.map(function(_){return G.Tags().NewTag("td",[_]);},_8);return G.Tags().NewTag("tr",_9);},_5),G.Tags().NewTag("tbody",_7))];return G.Tags().NewTag("table",_6);};d.MapOption=function(_5,_6){return _6!=null&&_6.$==1?{$:1,$0:_5(_6.$0)}:null;};d.Maybe=function(_5,_6,_7){return _7==null?_5:_6(_7.$0);};e.InputTextClass=function(){f.$cctor();return f.InputTextClass;};f.$cctor=function(){f.$cctor=a.ignore;f.InputTextClass="inputText";};g.New$1=function(_5,_6){return g.New(_5,_6);};g.New=function(_5,_6){return{Element:_5,Label:_6};};i=c.ElementStore=I.Class({Remove:function(_5){if(this.store.ContainsKey(_5)){(this.store.get_Item(_5))();this.store.Remove(_5);}},RegisterElement:function(_5,_6){if(!this.store.ContainsKey(_5))this.store.set_Item(_5,_6);},Init:function(){this.store=new K.New$5();}},h,i);i.NewElementStore=function(){var _5;_5=new i.New();_5.Init();return _5;};i.New=I.Ctor(function(){},i);k.get_Default=function(){return k.New(null,null,null,null);};k.New=function(_5,_6,_7,_8){return{Left:_5,Right:_6,Top:_7,Bottom:_8};};l.get_Default=function(){return l.New({$:0},{$:1},{$:0});};l.New=function(_5,_6,_7){return{Align:_5,VerticalAlign:_6,Placement:_7};};m.get_Default=function(){return m.New(null,null,null,null,null);};m.New=function(_5,_6,_7,_8,_9){return{Padding:_5,Color:_6,Class:_7,Style:_8,LabelConfiguration:_9};};n=c.LayoutProvider=I.Class({get_Horizontal:function(){return this.ColumnLayout(m.get_Default());},get_Vertical:function(){return this.RowLayout(m.get_Default());},LabelLayout:function(_5){var _6;return this.RowLayout((_6=m.get_Default(),m.New(_6.Padding,_6.Color,_6.Class,_6.Style,{$:1,$0:_5})));},get_Flowlet:function(){return this.MakeLayout(function(){var _5;function _6(_7,_8){var _9;_9=d.InTable(F.ofArray([F.ofArray([_8.Label!=null?_8.Label.$0():G.Tags().NewTag("span",[]),G.Tags().NewTag("div",[_8.Element])])]));_5.HtmlProvider.Clear(_5.get_Body());_5.AppendI(_9);return F.ofArray([_9]);}_5=G.Tags().NewTag("div",[]);return{Insert:function(_7){return function(_8){return _6(_7,_8);};},Panel:_5};});},ColumnLayout:function(_5){var _6;_6=this;return this.LayoutUtils.New(function(){var _7,_8,_9,_;function $(ba,bb){var bc,bd,be,bf,bg,bh,bi,bj;bc=bb.Element.get_Id();bd=(be=[(bf=[(bg=[_6.MakeRow(_5,ba,bb)],G.Tags().NewTag("tbody",bg))],G.Tags().NewTag("table",bf))],G.Tags().NewTag("td",be));bh=a.jQuery(_7.get_Body());bi=[0];bj=[false];bh.children().each(function(bk,bl){var bm;bm=a.jQuery(bl);ba===bi[0]?(a.jQuery(bd.get_Body()).insertBefore(bm),bd.Render(),bj[0]=true):void 0;bi[0]++;});!bj[0]?_7.AppendI(bd):void 0;return _.RegisterElement(bc,function(){bd.HtmlProvider.Remove(bd.get_Body());});}_7=G.Tags().NewTag("tr",[]);_8=(_9=[G.Tags().NewTag("tbody",[_7])],G.Tags().NewTag("table",_9));_=i.NewElementStore();return{Body:g.New(_8,null),SyncRoot:null,Insert:function(ba){return function(bb){return $(ba,bb);};},Remove:function(ba){var bb;bb=L.Get(ba);try{while(bb.MoveNext())_.Remove(bb.Current().Element.get_Id());}finally{if("Dispose"in bb)bb.Dispose();}}};});},RowLayout:function(_5){var _6;_6=this;return this.LayoutUtils.New(function(){var _7,_8,_9;function _($,ba){var bb,bc,bd,be,bf;bb=ba.Element.get_Id();bc=_6.MakeRow(_5,$,ba);bd=a.jQuery(_7.get_Body());be=[0];bf=[false];bd.children().each(function(bg,bh){var bi;bi=a.jQuery(bh);$===be[0]?(a.jQuery(bc.get_Body()).insertBefore(bi),bc.Render(),bf[0]=true):void 0;be[0]++;});!bf[0]?_7.AppendI(bc):void 0;return _9.RegisterElement(bb,function(){bc.HtmlProvider.Remove(bc.get_Body());});}_7=G.Tags().NewTag("tbody",[]);_8=G.Tags().NewTag("table",[_7]);_9=i.NewElementStore();return{Body:g.New(_8,null),SyncRoot:null,Insert:function($){return function(ba){return _($,ba);};},Remove:function($){var ba;ba=L.Get($);try{while(ba.MoveNext())_9.Remove(ba.Current().Element.get_Id());}finally{if("Dispose"in ba)ba.Dispose();}}};});},MakeLayout:function(_5){return this.LayoutUtils.New(function(){var _6,_7;function _8(_9,_){var $,ba;$=_.Element.get_Id();ba=(_6.Insert(_9))(_);return _7.RegisterElement($,function(){var bb,bc;bb=L.Get(ba);try{while(bb.MoveNext()){bc=bb.Current();bc.HtmlProvider.Remove(bc.get_Body());}}finally{if("Dispose"in bb)bb.Dispose();}});}_6=_5();_7=i.NewElementStore();return{Body:g.New(_6.Panel,null),SyncRoot:null,Insert:function(_9){return function(_){return _8(_9,_);};},Remove:function(_9){var _;_=L.Get(_9);try{while(_.MoveNext())_7.Remove(_.Current().Element.get_Id());}finally{if("Dispose"in _)_.Dispose();}}};});},MakeRow:function(_5,_6,_7){var _8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl;function bm(bn,bo,bp,bq,br,bs,bt){var bu,bv,bw;function bx(by,bz){return by+a.String(bz)+"px;";}bu=M.reduce(function(by,bz){return by+bz;},F.map(function(by){return bx(by[0],by[1]);},F.ofArray([["padding-left: ",bn],["padding-top: ",bo],["padding-right: ",bp],["padding-bottom: ",bq]])));bv=d.Maybe("",function(by){return"vertical-align: "+(by.$==1?"middle":by.$==2?"bottom":"top")+";";},bs);bw=F.append(new F.T({$:1,$0:N.Attr().NewAttr("style",bu+";"+bv),$1:br?F.ofArray([N.Attr().NewAttr("colspan","2")]):F.T.Empty}),F.ofArray([bt]));return G.Tags().NewTag("td",bw);}_8=d.Maybe(k.get_Default(),a.id,_5.Padding);_9=d.Maybe(0,a.id,_8.Left);_=d.Maybe(0,a.id,_8.Top);$=d.Maybe(0,a.id,_8.Right);ba=d.Maybe(0,a.id,_8.Bottom);bb=_7.Element;bc=(bd=_7.Label,bd!=null&&bd.$==1?(be=d.Maybe(l.get_Default(),a.id,_5.LabelConfiguration),(bf=this.HorizontalAlignElem(be.Align,bd.$0()),(bg=be.Placement,bg.$==3?F.ofArray([bm(_9,_,$,ba,true,null,d.InTable(F.ofArray([F.ofArray([bb]),F.ofArray([bf])])))]):bg.$==0?F.ofArray([bm(_9,_,0,ba,false,{$:1,$0:be.VerticalAlign},bf),bm(0,_,$,ba,false,null,bb)]):bg.$==1?F.ofArray([bm(_9,_,0,ba,false,{$:1,$0:be.VerticalAlign},bb),bm(0,_,$,ba,false,null,bf)]):F.ofArray([bm(_9,_,$,ba,true,null,d.InTable(F.ofArray([F.ofArray([bf]),F.ofArray([bb])])))])))):F.ofArray([bm(_9,_,$,ba,true,null,bb)]));bh=d.Maybe(F.T.Empty,function(bn){var bo;return F.ofArray([(bo=bn(_6),N.Attr().NewAttr("class",bo))]);},_5.Class);bi=(bj=F.append(d.Maybe(F.T.Empty,function(bn){return F.ofArray(["background-color: "+bn(_6)]);},_5.Color),d.Maybe(F.T.Empty,function(bn){return F.ofArray([bn(_6)]);},_5.Style)),bj.$==0?F.T.Empty:F.ofArray([(bk=M.reduce(function(bn,bo){return bn+";"+bo;},bj),N.Attr().NewAttr("style",bk))]));bl=F.append(bh,F.append(bi,F.append(bi,bc)));return G.Tags().NewTag("tr",bl);},VerticalAlignedTD:function(_5,_6){var _7;_7=G.Tags().NewTag("td",[_6]);_7.HtmlProvider.SetCss(_7.get_Body(),"vertical-align",_5.$==1?"middle":_5.$==2?"bottom":"top");return _7;},HorizontalAlignElem:function(_5,_6){var _7;return O.add((_7=[N.Attr().NewAttr("style","float:"+(_5.$==0?"left":"right")+";")],G.Tags().NewTag("div",_7)),[_6]);}},h,n);n.New=I.Ctor(function(_5){this.LayoutUtils=_5;},n);s=r.Formlet=I.Class({Run:function(_5){var _6,_7,_8,_9,_;_6=this.get_ElementInternal();return _6==null?(_7=this.formletBase.ApplyLayout(this),(_8=_7.BuildI(),(_8.State.Subscribe(P.observer(function($){S.Map(_5,$);})),_9=(_=_7.LayoutI().Apply(_8.Body),_==null?r.DefaultLayout().Apply(_8.Body).$0[0].Element:_.$0[0].Element),this.set_ElementInternal({$:1,$0:_9}),_9))):_6.$0;},set_ElementInternal:function(_5){this.ElementInternal=_5;},get_ElementInternal:function(){return this.ElementInternal;},Render:function(){this.Run(a.ignore).Render();},get_Body:function(){return this.Run(a.ignore).get_Body();},MapResultI:function(_5){var _6;_6=this;return new s.New(function(){var _7;_7=_6.buildInternal();return T.New(_7.Body,_7.Dispose$1,_7.Notify,_6.utils.Reactive.Select(_7.State,_5));},this.layoutInternal,this.formletBase,this.utils);},LayoutI:function(){return this.layoutInternal;},BuildI:function(){return this.buildInternal();}},q,s);s.New=I.Ctor(function(_5,_6,_7,_8){q.New.call(this);this.buildInternal=_5;this.layoutInternal=_6;this.formletBase=_7;this.utils=_8;this.ElementInternal=null;},s);t=r.ValidatorProvidor=I.Class({Matches:function(_5,_6){return _6.match(new a.RegExp(_5));}},h,t);t.New=I.Ctor(function(){},t);r.$=function(_5,_6){return r.OfIFormlet(r.BaseFormlet().Apply(_5,_6));};r.Validator=function(){w.$cctor();return w.Validator;};r.MkFormlet=function(_5){return r.OfIFormlet(r.BaseFormlet().New(function(){var _6,_7,_8;_6=_5();_7=_6[1];return T.New((_8=U.Set(r.NewBody(_6[0],null)),r.RX().Return(_8)),a.ignore,function(){_7();},_6[2]);}));};r.OfIFormlet=function(_5){return r.PropagateRenderFrom(_5,new s.New(function(){return _5.BuildI();},_5.LayoutI(),r.BaseFormlet(),r.UtilsProvider()));};r.PropagateRenderFrom=function(_5,_6){_5.hasOwnProperty("Render")?_6.Render=_5.Render:void 0;return _6;};r.BaseFormlet=function(){return new V.New(r.UtilsProvider());};r.UtilsProvider=function(){return{Reactive:r.RX(),DefaultLayout:r.DefaultLayout()};};r.DefaultLayout=function(){w.$cctor();return w.DefaultLayout;};r.set_DefaultLayout=function(_5){w.$cctor();w.DefaultLayout=_5;};r.Layout=function(){w.$cctor();return w.Layout;};r.RX=function(){w.$cctor();return w.RX;};r.NewBody=function(_5,_6){return g.New$1(_5,_6);};u=c.FormletBuilder=I.Class({ReturnFrom:function(_5){return r.OfIFormlet(_5);},Delay:function(_5){return r.OfIFormlet(r.BaseFormlet().Delay(_5));},Bind:function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().Bind(_5,_6)));},Return:function(_5){return r.OfIFormlet(r.BaseFormlet().Return(_5));}},h,u);u.New=I.Ctor(function(){},u);v.Choose=function(_5){var _6,_7;_6=[0];return v.Map(function(_8){return _8.$0;},(_7=v.Map(function(_8){function _9($,ba){return{$:1,$0:$};}function _($,ba){return ba;}return M.tryPick(function($){return _9($[0],$[1]);},F.rev(F.sortBy(function($){return _($[0],$[1]);},F.choose(function($){return $.$==0?{$:1,$0:$.$0}:null;},_8))));},v.Sequence(M.map(function(_8){return v.LiftResult(v.InitWithFailure(v.Map(function(_9){_6[0]++;return[_9,_6[0]];},_8)));},_5))),r.Validator().Is(function(_8){return _8!=null;},"",_7)));};v.Render=function(_5){return r.PropagateRenderFrom(_5,_5.Run(a.ignore));};v.BindWith=function(_5,_6,_7){return r.OfIFormlet(r.PropagateRenderFrom(_6,r.BaseFormlet().BindWith(_5,_6,_7)));};v.Run=function(_5,_6){return _6.Run(_5);};v.WithLabel=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_6,r.BaseFormlet().MapBody(function(_7){return g.New(_7.Element,_5);},_6)));};v.OfElement=function(_5){return r.MkFormlet(function(){return[_5(),a.ignore,r.RX().Return({$:0,$0:null})];});};v.MapElement=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_6,r.BaseFormlet().MapBody(function(_7){return g.New(_5(_7.Element),_7.Label);},_6)));};v.ApplyLayout=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().ApplyLayout(_5)));};v.WithNotificationChannel=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().WithNotificationChannel(_5)));};v.WithNotification=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_6,r.BaseFormlet().WithNotification(_5,_6)));};v.WithLayout=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_6,r.BaseFormlet().WithLayout(_5,_6)));};v.Sequence=function(_5){return r.OfIFormlet(r.BaseFormlet().Sequence(M.map(a.id,_5)));};v.LiftResult=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().LiftResult(_5)));};v.SelectMany=function(_5){var _6;return r.OfIFormlet(r.PropagateRenderFrom(_5,(_6=v.Map(a.id,_5),r.BaseFormlet().SelectMany(_6))));};v.FlipBody=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().FlipBody(_5)));};v.Switch=function(_5){var _6;return r.OfIFormlet(r.PropagateRenderFrom(_5,(_6=v.Map(a.id,_5),r.BaseFormlet().Switch(_6))));};v.Join=function(_5){var _6;return r.OfIFormlet(r.PropagateRenderFrom(_5,(_6=v.Map(a.id,_5),r.BaseFormlet().Join(_6))));};v.Replace=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().Replace(_5,_6)));};v.Bind=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().Bind(_5,_6)));};v.Delay=function(_5){return r.OfIFormlet(r.BaseFormlet().Delay(_5));};v.MapResult=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_6,r.BaseFormlet().MapResult(_5,_6)));};v.MapBody=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_6,r.BaseFormlet().MapBody(_5,_6)));};v.Map=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_6,r.BaseFormlet().Map(_5,_6)));};v.Do=function(){w.$cctor();return w.Do;};v.FailWith=function(_5){return r.OfIFormlet(r.BaseFormlet().FailWith(_5));};v.Deletable=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().Deletable(_5)));};v.BuildForm=function(_5){return r.BaseFormlet().BuildForm(_5);};v.ReturnEmpty=function(_5){return r.OfIFormlet(r.BaseFormlet().ReturnEmpty(_5));};v.Empty=function(){return r.OfIFormlet(r.BaseFormlet().Empty());};v.Never=function(){return r.OfIFormlet(r.BaseFormlet().Never());};v.ReplaceFirstWithFailure=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().ReplaceFirstWithFailure(_5)));};v.Flowlet=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().WithLayout(r.Layout().get_Flowlet(),_5)));};v.Vertical=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().WithLayout(r.Layout().get_Vertical(),_5)));};v.Horizontal=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().WithLayout(r.Layout().get_Horizontal(),_5)));};v.InitWithFailure=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().InitWithFailure(_5)));};v.InitWith=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_6,r.BaseFormlet().InitWith(_5,_6)));};v.WithCancelation=function(_5,_6){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().WithCancelation(_5,_6)));};v.Return=function(_5){return r.OfIFormlet(r.BaseFormlet().Return(_5));};v.WithLayoutOrDefault=function(_5){return r.OfIFormlet(r.PropagateRenderFrom(_5,r.BaseFormlet().WithLayoutOrDefault(_5)));};v.New=function(_5){return r.OfIFormlet(r.BaseFormlet().New(_5));};v.BuildFormlet=function(_5){return r.MkFormlet(_5);};w.$cctor=function(){w.$cctor=a.ignore;w.RX=X.Default();w.Layout=new n.New(new Y.New({Reactive:X.Default()}));w.DefaultLayout=r.Layout().get_Vertical();w.Validator=new Z.New(new t.New());w.Do=new u.New();};x.Button=function(_5){return x.ElementButton(function(){var _6;_6=[G.Tags().text(_5)];return G.Tags().NewTag("button",_6);});};x.ElementButton=function(_5){return r.MkFormlet(function(){var _6,_7,_8;function _9(_,$){_6.Trigger({$:0,$0:_7[0]});_7[0]++;}_6=_0.New$1({$:1,$0:F.T.Empty});_7=[0];return[(_8=_5(),(function(_){_1.Events().OnClick(function($){return function(ba){return _9($,ba);};},_);}(_8),_8)),function(){_7[0]=0;_6.Trigger({$:1,$0:F.T.Empty});},_6];});};x.ReadOnlyInput=function(_5){return x.InputField(true,"text",e.InputTextClass(),_5);};x.Input=function(_5){return x.InputField(false,"text",e.InputTextClass(),_5);};x.Password=function(_5){return x.InputField(false,"password","inputPassword",_5);};x.ReadOnlyRadioButtonGroup=function(_5,_6){return x.RadioButtonGroupControl(true,_5,_6);};x.RadioButtonGroup=function(_5,_6){return x.RadioButtonGroupControl(false,_5,_6);};x.RadioButtonGroupControl=function(_5,_6,_7){return v.New(function(){var _8,_9,_,$,ba;function bb(bf,bg){return _6==null?null:_6.$0===bf?{$:1,$0:{$:0,$0:bg}}:null;}function bc(bf,bg){var bh;return[O.add((bh=[N.Attr().NewAttr("class","inputRadio"),N.Attr().NewAttr("type","radio"),N.Attr().NewAttr("name",_8)],G.Tags().NewTag("input",bh)),_5?F.ofArray([N.Attr().NewAttr("disabled","disabled")]):F.T.Empty),bf,bg];}function bd(bf,bg,bh){return _6==null?(bf.HtmlProvider.RemoveAttribute(bf.get_Body(),"checked"),_9.Trigger({$:1,$0:F.T.Empty})):_6.$0===bh?(bf.HtmlProvider.SetProperty(bf.get_Body(),"checked",true),_9.Trigger({$:0,$0:bg})):bf.HtmlProvider.SetProperty(bf.get_Body(),"checked",false);}function be(){F.iteri(function(bf,bg){return bd(bg[0],bg[2],bf);},$);}_8="id"+_2.round(_2.random()*100000000);_9=(_=_6==null?null:M.tryPick(function(bf){return bb(bf[0],bf[1]);},F.mapi(function(bf,bg){return[bf,bg[1]];},_7)),d.Maybe(_0.New$1({$:1,$0:F.T.Empty}),_0.New$1,_));$=F.map(function(bf){return bc(bf[0],bf[1]);},_7);return T.New((ba=new U.Edit({$:0,$0:U.FromSequence(F.mapi(function(bf,bg){var bh,bi,bj;function bk(bl,bm){return!_5?_9.Trigger({$:0,$0:bj}):null;}bh=bg[0];bi=bg[1];bj=bg[2];bd(bh,bj,bf);_1.Events().OnClick(function(bl){return function(bm){return bk(bl,bm);};},bh);return g.New(bh,{$:1,$0:function(){var bl;bl=[G.Tags().text(bi)];return G.Tags().NewTag("label",bl);}});},$))}),r.RX().Return(ba)),a.ignore,function(){be();},_9);});};x.CheckboxGroup=function(_5){return x.CheckboxGroupControl(false,_5);};x.CheckboxGroupControl=function(_5,_6){function _7(_9,_){return _9?{$:1,$0:_}:null;}function _8(_9,_,$){return v.Map(function(ba){return[ba,_];},v.WithLabel({$:1,$0:function(){var ba;ba=[G.Tags().text(_9)];return G.Tags().NewTag("label",ba);}},x.CheckboxControl(_5,$)));}return v.Map(function(_9){return F.choose(function(_){return _7(_[0],_[1]);},_9);},v.Sequence(F.map(function(_9){return _8(_9[0],_9[1],_9[2]);},_6)));};x.ReadOnlyCheckbox=function(_5){return x.CheckboxControl(true,_5);};x.Checkbox=function(_5){return x.CheckboxControl(false,_5);};x.CheckboxControl=function(_5,_6){return r.MkFormlet(function(){var _7,_8,_9,_,$;function ba(bc,bd){return!_5?_7.Trigger({$:0,$0:a.jQuery(bc.get_Body()).prop("checked")}):null;}function bb(){_6?_8.HtmlProvider.SetProperty(_8.get_Body(),"checked",true):(_8.HtmlProvider.RemoveAttribute(_8.get_Body(),"checked"),_8.HtmlProvider.SetProperty(_8.get_Body(),"checked",false));_7.Trigger({$:0,$0:_6});}_7=_0.New$1({$:0,$0:_6});_8=(_9=_5?F.ofArray([N.Attr().NewAttr("disabled","disabled")]):F.T.Empty,(_=O.add(($=[N.Attr().NewAttr("type","checkbox"),N.Attr().NewAttr("class","inputCheckbox")],G.Tags().NewTag("input",$)),_9),(function(bc){_1.Events().OnClick(function(bd){return function(be){return ba(bd,be);};},bc);}(_),_)));_6?_8.HtmlProvider.SetAttribute(_8.get_Body(),"defaultChecked","true"):_8.HtmlProvider.RemoveAttribute(_8.get_Body(),"checked");bb();return[_8,bb,_7];});};x.InputField=function(_5,_6,_7,_8){return x.InputControl(_8,function(_9){var _,$,ba;function bb(){if(!_5)_9.Trigger({$:0,$0:_.get_Value()});}_=($=_5?F.ofArray([N.Attr().NewAttr("readonly","readonly")]):F.T.Empty,(ba=F.append(F.ofArray([N.Attr().NewAttr("type",_6),N.Attr().NewAttr("class",_7)]),$),G.Tags().NewTag("input",ba)));(function(bc){x.OnTextChange(bb,bc);}(_));return _;});};x.ReadOnlyTextArea=function(_5){return x.TextAreaControl(true,_5);};x.TextArea=function(_5){return x.TextAreaControl(false,_5);};x.TextAreaControl=function(_5,_6){return x.InputControl(_6,function(_7){var _8,_9;function _(){if(!_5)_7.Trigger({$:0,$0:_8.get_Value()});}_8=(_9=_5?F.ofArray([N.Attr().NewAttr("readonly","readonly")]):F.T.Empty,G.Tags().NewTag("textarea",_9));(function($){x.OnTextChange(_,$);}(_8));return _8;});};x.OnTextChange=function(_5,_6){var _7;function _8(){if(_6.get_Value()!==_7[0]){_7[0]=_6.get_Value();_5();}}function _9(ba){_8();}function _(ba,bb){return _9(ba);}function $(ba,bb){return _8();}_7=[_6.get_Value()];_1.Events().OnChange(function(ba){return function(bb){return _(ba,bb);};},_6);_1.Events().OnKeyUp(function(ba){return function(bb){return $(ba,bb);};},_6);_6.Dom.oninput=_8;};x.InputControl=function(_5,_6){return r.MkFormlet(function(){var _7,_8;_7=_0.New$1({$:0,$0:_5});_8=_6(_7);_8.set_Value(_5);return[_8,function(){_8.set_Value(_5);_7.Trigger({$:0,$0:_5});},_7];});};x.ReadOnlySelect=function(_5,_6){return x.SelectControl(true,_5,_6);};x.Select=function(_5,_6){return x.SelectControl(false,_5,_6);};x.SelectControl=function(_5,_6,_7){return r.MkFormlet(function(){var _8,_9,_,$,ba,bb;function bc(){_.HtmlProvider.SetProperty(_.get_Body(),"value",a.String(_9));bb.Trigger(ba);}function bd(bf){if(!_5)bb.Trigger({$:0,$0:_3.get(_8,a.Number(_.get_Value()))});}function be(bf,bg){return bd(bf);}_8=_3.ofList(F.map(function(bf){return bf[1];},_7));_9=_6>=0&&_6<_7.get_Length()?_6:0;_=_5?O.add(($=F.mapi(function(bf,bg){return G.Tags().NewTag("option",[G.Tags().text(bg[0]),N.Attr().NewAttr("value",a.String(bf))]);},_7),G.Tags().NewTag("select",$)),[N.Attr().NewAttr("disabled","disabled")]):($=F.mapi(function(bf,bg){return G.Tags().NewTag("option",[G.Tags().text(bg[0]),N.Attr().NewAttr("value",a.String(bf))]);},_7),G.Tags().NewTag("select",$));ba={$:0,$0:_3.get(_8,_9)};bb=_0.New$1(ba);bc();_1.Events().OnChange(function(bf){return function(bg){return be(bf,bg);};},_);bc();return[_,bc,bb];});};z.get_Default=function(){return z.New(null,null,null);};z.New=function(_5,_6,_7){return{Label:_5,Style:_6,Class:_7};};A.get_Default=function(){return A.New("validIcon","errorIcon");};A.New=function(_5,_6){return{ValidIconClass:_5,ErrorIconClass:_6};};B.get_Default=function(){return B.New({$:1,$0:"successFormlet"},null,{$:1,$0:"errorFormlet"},null);};B.New=function(_5,_6,_7,_8){return{ValidClass:_5,ValidStyle:_6,ErrorClass:_7,ErrorStyle:_8};};C.get_Default=function(){return C.New(null,null,null,null);};C.New=function(_5,_6,_7,_8){return{Left:_5,Right:_6,Top:_7,Bottom:_8};};D.get_Default=function(){return D.New(null,C.get_Default(),null,null,null,null,null);};D.New=function(_5,_6,_7,_8,_9,_,$){return{Header:_5,Padding:_6,Description:_7,BackgroundColor:_8,BorderColor:_9,CssClass:_,Style:$};};E.get_Default=function(){return E.New("addIcon","removeIcon");};E.New=function(_5,_6){return{AddIconClass:_5,RemoveIconClass:_6};};y.WithJsonPost=function(_5,_6){var _7,_8,_9,_,$,ba,bb,bc,bd;function be(bf){var bg;bg=_5.EncodingType;bg==null?void 0:bg.$0==="multipart/form-data"?a.jQuery(bf.get_Body()).attr("encoding","multipart/form-data"):void 0;}_7=(_8=_5.PostUrl,_8==null?F.T.Empty:F.ofArray([N.Attr().NewAttr("action",_8.$0)]));_9=(_=_5.EncodingType,_==null?F.T.Empty:F.ofArray([N.Attr().NewAttr("enctype",_.$0)]));$=G.Tags().NewTag("input",[N.Attr().NewAttr("type","hidden"),N.Attr().NewAttr("name",_5.ParameterName)]);ba=G.Tags().NewTag("input",[N.Attr().NewAttr("type","submit"),N.Attr().NewAttr("value","Submit")]);bb=[(bc=O.add((bd=F.append(new F.T({$:1,$0:N.Attr().NewAttr("method","POST"),$1:new F.T({$:1,$0:N.Attr().NewAttr("style","display:none"),$1:_7})}),_9),G.Tags().NewTag("form",bd)),[$,ba]),(function(bf){O.OnAfterRender(be,bf);}(bc),bc)),v.Map(function(bf){var bg;bg=_4.stringify(bf);a.jQuery($.get_Body()).val(bg);return a.jQuery(ba.get_Body()).click();},_6)];return G.Tags().NewTag("div",bb);};y.Many=function(_5){return y.CustomMany(E.get_Default(),_5);};y.CustomMany=function(_5,_6){var _7,_8,_9,_,$,ba;function bb(){return v.ApplyLayout(v.WithLayoutOrDefault(v.Map(F.ofSeq,y.Many_(_7,function(){return _8;}))));}_7=v.InitWith(1,x.ElementButton(function(){var bc;return O.add((bc=[N.Attr().NewAttr("class",_5.AddIconClass)],G.Tags().NewTag("div",bc)),[G.Tags().NewTag("div",[])]);}));_8=y.Deletable((_9=v.WithCancelation(_6,v.Map(a.ignore,x.ElementButton(function(){var bc;return O.add((bc=[N.Attr().NewAttr("class",_5.RemoveIconClass)],G.Tags().NewTag("div",bc)),[G.Tags().NewTag("div",[])]);}))),v.WithLayout(r.Layout().get_Horizontal(),_9)));_=_0.New$1({$:0,$0:null});$=r.OfIFormlet(r.BaseFormlet().FromState(_));return v.WithNotification(function(){_.Trigger({$:0,$0:null});},(ba=v.Do(),ba.Delay(function(){return ba.Bind($,function(){return ba.ReturnFrom(bb());});})));};y.Many_=function(_5,_6){return v.Map(function(_7){return M.choose(a.id,_7);},v.FlipBody(v.SelectMany(v.Map(_6,_5))));};y.Deletable=function(_5){return y.Replace(_5,function(_6){return _6!=null&&_6.$==1?v.Return({$:1,$0:_6.$0}):v.ReturnEmpty(null);});};y.Replace=function(_5,_6){return v.Switch(v.MapResult(function(_7){return _7.$==1?{$:0,$0:v.FailWith(_7.$0)}:{$:0,$0:_6(_7.$0)};},_5));};y.Cancel=function(_5,_6){return v.Replace(_5,function(_7){return _6(_7)?v.Empty():v.Return(_7);});};y.WithRowConfiguration=function(_5,_6){var _7;_7=v.ApplyLayout(_6);return v.WithLayout(r.Layout().RowLayout(_5),_7);};y.WithLegend=function(_5,_6){return v.MapBody(function(_7){var _8,_9,_;return g.New((_8=[(_9=[G.Tags().text(_5)],G.Tags().NewTag("legend",_9)),(_=_7.Label,_==null?_7.Element:d.InTable(F.ofArray([F.ofArray([_.$0(),_7.Element])])))],G.Tags().NewTag("fieldset",_8)),null);},_6);};y.WithCssClass=function(_5,_6){return v.MapElement(function(_7){_7.HtmlProvider.AddClass(_7.get_Body(),_5);return _7;},_6);};y.WithFormContainer=function(_5){return y.WithCustomFormContainer(D.get_Default(),_5);};y.WithCustomFormContainer=function(_5,_6){return v.MapElement(function(_7){var _8,_9,_,$,ba,bb,bc,bd,be;function bf(bg,bh){if(bh==null);else $.HtmlProvider.SetCss($.get_Body(),bg,bh.$0);}_8=d.Maybe(F.T.Empty,function(bg){var bh;return bg.$==1?F.ofArray([bg.$0()]):F.ofArray([(bh=[G.Tags().text(bg.$0)],G.Tags().NewTag("p",bh))]);},_5.Description);_9=d.Maybe(d.InTable(F.ofArray([F.ofArray([O.add((_=[N.Attr().NewAttr("class","headerPanel")],G.Tags().NewTag("div",_)),_8)]),F.ofArray([_7])])),function(bg){var bh,bi,bj;return d.InTable(F.ofArray([F.ofArray([(bh=bg.$==1?bg.$0():(bi=[G.Tags().text(bg.$0)],G.Tags().NewTag("h1",bi)),O.add((bj=[N.Attr().NewAttr("class","headerPanel")],G.Tags().NewTag("div",bj)),new F.T({$:1,$0:bh,$1:_8})))]),F.ofArray([_7])]));},_5.Header);$=O.add((ba=[N.Attr().NewAttr("class","formlet")],G.Tags().NewTag("td",ba)),[_9]);d.Maybe(null,function(bg){$.HtmlProvider.SetStyle($.get_Body(),"border-color: "+bg);},_5.BorderColor);F.iter(function(bg){return bf(bg[0],bg[1]);},F.ofArray([["background-color",d.MapOption(a.id,_5.BackgroundColor)],["padding-left",d.MapOption(function(bg){return a.String(bg)+"px";},_5.Padding.Left)],["padding-right",d.MapOption(function(bg){return a.String(bg)+"px";},_5.Padding.Right)],["padding-top",d.MapOption(function(bg){return a.String(bg)+"px";},_5.Padding.Top)],["padding-bottom",d.MapOption(function(bg){return a.String(bg)+"px";},_5.Padding.Bottom)]]));bb=_5.Style;bb==null?void 0:$.HtmlProvider.SetStyle($.get_Body(),bb.$0);bc=_5.CssClass;bc==null?void 0:$.HtmlProvider.AddClass($.get_Body(),bc.$0);bd=[(be=[G.Tags().NewTag("tr",[$])],G.Tags().NewTag("tbody",be))];return G.Tags().NewTag("table",bd);},v.ApplyLayout(_6));};y.WithLabelLeft=function(_5){return v.MapBody(function(_6){var _7,_8,_9,_,$;return g.New((_7=(_8=_6.Label,_8==null?G.Tags().NewTag("span",[]):_8.$0()),(_9=[(_=[($=[G.Tags().NewTag("td",[_6.Element]),G.Tags().NewTag("td",[_7])],G.Tags().NewTag("tr",$))],G.Tags().NewTag("tbody",_))],G.Tags().NewTag("table",_9))),null);},_5);};y.WithLabelAbove=function(_5){return v.MapBody(function(_6){var _7,_8,_9,_,$,ba;return g.New((_7=[(_8=[(_9=[(_=[($=_6.Label,$==null?G.Tags().NewTag("span",[]):$.$0())],G.Tags().NewTag("td",_))],G.Tags().NewTag("tr",_9)),(ba=[G.Tags().NewTag("td",[_6.Element])],G.Tags().NewTag("tr",ba))],G.Tags().NewTag("tbody",_8))],G.Tags().NewTag("table",_7)),null);},_5);};y.WithTextLabel=function(_5,_6){return y.WithLabel(function(){var _7;_7=[G.Tags().text(_5)];return G.Tags().NewTag("label",_7);},_6);};y.WithLabelAndInfo=function(_5,_6,_7){return y.WithLabel(function(){var _8,_9;return d.InTable(F.ofArray([F.ofArray([(_8=[G.Tags().text(_5)],G.Tags().NewTag("label",_8)),(_9=[N.Attr().NewAttr("title",_6),N.Attr().NewAttr("class","infoIcon")],G.Tags().NewTag("span",_9))])]));},_7);};y.WithLabelConfiguration=function(_5,_6){var _7;_7=v.ApplyLayout(_6);return v.WithLayout(r.Layout().LabelLayout(_5),_7);};y.WithLabel=function(_5,_6){return v.WithLabel({$:1,$0:_5},_6);};y.WithErrorFormlet=function(_5,_6){var _7;return v.MapResult(S.Join,(_7=v.Do(),_7.Delay(function(){return _7.Bind(v.LiftResult(_6),function(_8){var _9,_;return _7.ReturnFrom(_8.$==1?(_9=_8.$0,(_=v.Do(),_.Delay(function(){return _.Bind(_5(_9),function(){return _.Return(_8);});}))):v.Return(_8));});})));};y.WithValidationFrame=function(_5){return y.WithCustomValidationFrame(B.get_Default(),_5);};y.WithErrorSummary=function(_5,_6){var _7;function _8(_9){return v.OfElement(function(){var _,$,ba;_=[($=[G.Tags().text(_5)],G.Tags().NewTag("legend",$)),(ba=F.map(function(bb){var bc;bc=[G.Tags().text(bb)];return G.Tags().NewTag("li",bc);},_9),G.Tags().NewTag("ul",ba))];return G.Tags().NewTag("fieldset",_);});}return v.MapResult(S.Join,(_7=v.Do(),_7.Delay(function(){return _7.Bind(v.LiftResult(_6),function(_9){return _7.ReturnFrom(_9.$==1?v.Map(function(){return _9;},_8(_9.$0)):v.Return(_9));});})));};y.WithSubmitButton=function(_5){return y.WithCustomSubmitButton(z.get_Default(),_5);};y.WithCustomSubmitButton=function(_5,_6){var _7;_7=_5.Label==null?z.New({$:1,$0:"Submit"},_5.Style,_5.Class):_5;return y.WithSubmitFormlet(_6,function(_8){return v.Map(a.ignore,y.InputButton(_7,_8.$==0&&true));});};y.WithResetButton=function(_5){return y.WithCustomResetButton(z.get_Default(),_5);};y.WithCustomResetButton=function(_5,_6){return y.WithResetFormlet(_6,y.InputButton(_5.Label==null?z.New({$:1,$0:"Reset"},_5.Style,_5.Class):_5,true));};y.WithCustomValidationFrame=function(_5,_6){return y.WrapFormlet(function(_7,_8){var _9;function _($){_7.Subscribe(P.observer(function(ba){var bb,bc,bd,be,bf,bg;if(ba.$==1){bb=_5.ValidClass;bb!=null&&bb.$==1?$.HtmlProvider.RemoveClass($.get_Body(),bb.$0):void 0;bc=_5.ErrorClass;bc!=null&&bc.$==1?$.HtmlProvider.AddClass($.get_Body(),bc.$0):void 0;bd=_5.ErrorStyle;bd!=null&&bd.$==1?$.HtmlProvider.SetStyle($.get_Body(),bd.$0):$.HtmlProvider.SetStyle($.get_Body(),"");}else{be=_5.ErrorClass;be!=null&&be.$==1?$.HtmlProvider.RemoveClass($.get_Body(),be.$0):void 0;bf=_5.ValidClass;bf!=null&&bf.$==1?$.HtmlProvider.AddClass($.get_Body(),bf.$0):void 0;bg=_5.ValidStyle;bg!=null&&bg.$==1?$.HtmlProvider.SetStyle($.get_Body(),bg.$0):$.HtmlProvider.SetStyle($.get_Body(),"");}}));}_9=G.Tags().NewTag("div",[_8.Element]);(function($){O.OnAfterRender(_,$);}(_9));return _9;},_6);};y.WrapFormlet=function(_5,_6){return r.MkFormlet(function(){var _7,_8;_7=v.WithLayoutOrDefault(_6);_8=v.BuildForm(_7);return[_5(_8.State,_7.LayoutI().Apply(_8.Body).$0[0]),function(){_8.Notify(null);},_8.State];});};y.WithValidationIcon=function(_5){return y.WithCustomValidationIcon(A.get_Default(),_5);};y.WithCustomValidationIcon=function(_5,_6){var _7,_8,_9;function _($){return v.OfElement(function(){var ba,bb,bc;return $.$==1?(ba=M.fold(function(bd,be){return bd+" "+be;},"",$.$0),O.add((bb=[N.Attr().NewAttr("class",_5.ErrorIconClass),N.Attr().NewAttr("title",ba)],G.Tags().NewTag("div",bb)),[G.Tags().NewTag("div",[])])):O.add((bc=[N.Attr().NewAttr("class",_5.ValidIconClass),N.Attr().NewAttr("title","")],G.Tags().NewTag("div",bc)),[G.Tags().NewTag("div",[])]);});}_7=v.WithLayoutOrDefault(_6);_8=v.MapResult(S.Join,(_9=v.Do(),_9.Delay(function(){return _9.Bind(v.LiftResult(_7),function($){return _9.Bind(_($),function(){return _9.Return($);});});})));return v.WithLayout(r.Layout().get_Horizontal(),_8);};y.WithSubmitAndResetButtons=function(_5){var _6,_7;return y.WithCustomSubmitAndResetButtons((_6=z.get_Default(),z.New({$:1,$0:"Submit"},_6.Style,_6.Class)),(_7=z.get_Default(),z.New({$:1,$0:"Reset"},_7.Style,_7.Class)),_5);};y.WithCustomSubmitAndResetButtons=function(_5,_6,_7){return y.WithSubmitAndReset(_7,function(_8,_9){var _,$,ba,bb,bc,bd;_=_9.$==1?($=_9.$0,v.MapResult(function(){return{$:1,$0:$};},y.InputButton(_5,false))):(ba=_9.$0,v.Map(function(){return ba;},y.InputButton(_5,true)));bb=(bc=v.Do(),bc.Delay(function(){return bc.Bind(v.LiftResult(y.InputButton(_6,true)),function(be){be.$==0?_8():void 0;return bc.Return();});}));bd=r.$(r.$(v.Return(function(be){return function(){return be;};}),_),bb);return v.WithLayout(r.Layout().get_Horizontal(),bd);});};y.InputButton=function(_5,_6){return r.MkFormlet(function(){var _7,_8,_9,_,$,ba,bb,bc,bd;function be(bf,bg){_8[0]++;return _7.Trigger({$:0,$0:_8[0]});}_7=_0.New$1({$:1,$0:F.T.Empty});_8=[0];_9=(_=d.Maybe("Submit",a.id,_5.Label),($=(ba=O.add((bb=[N.Attr().NewAttr("type","button")],G.Tags().NewTag("input",bb)),[N.Attr().NewAttr("class","submitButton"),N.Attr().NewAttr("value",_)]),(function(bf){_1.Events().OnClick(function(bg){return function(bh){return be(bg,bh);};},bf);}(ba),ba)),(!_6?$.HtmlProvider.AddClass($.get_Body(),"disabledButton"):void 0,bc=_5.Style,bc!=null&&bc.$==1?$.HtmlProvider.SetStyle($.get_Body(),bc.$0):void 0,bd=_5.Class,bd!=null&&bd.$==1?$.HtmlProvider.AddClass($.get_Body(),bd.$0):void 0,$)));_7.Trigger({$:1,$0:F.T.Empty});return[_9,function(){_8[0]=0;_7.Trigger({$:1,$0:F.T.Empty});},_7];});};y.WithSubmitAndReset=function(_5,_6){var _7;return r.OfIFormlet(r.PropagateRenderFrom(_5,(_7=v.Do(),_7.Delay(function(){return _7.Bind(v.WithNotificationChannel(v.LiftResult(v.InitWithFailure(_5))),function(_8){var _9;_9=_8[1];return _7.ReturnFrom(_6(function(){_9(void 0);},_8[0]));});}))));};y.WithSubmitFormlet=function(_5,_6){var _7;return r.OfIFormlet(r.PropagateRenderFrom(_5,v.MapResult(S.Join,(_7=v.Do(),_7.Delay(function(){return _7.Bind(v.LiftResult(v.InitWithFailure(_5)),function(_8){return _7.Bind(_6(_8),function(){return _7.Return(_8);});});})))));};y.WithResetAction=function(_5,_6){var _7;return r.OfIFormlet(r.PropagateRenderFrom(_6,(_7=v.New(function(){var _8;_8=_6.BuildI();return T.New(_8.Body,_8.Dispose$1,function(_9){if(_5())_8.Notify(_9);},_8.State);}),v.WithLayout(_6.LayoutI(),_7))));};y.WithResetFormlet=function(_5,_6){var _7,_8,_9;_7=v.WithNotificationChannel(v.LiftResult(v.InitWithFailure(v.ApplyLayout(v.WithLayoutOrDefault(_5)))));_8=v.LiftResult(_6);return r.OfIFormlet(r.PropagateRenderFrom(_7,v.MapResult(S.Join,(_9=v.Do(),_9.Delay(function(){return _9.Bind(_7,function(_){var $,ba;$=_[0];ba=_[1];return _9.Bind(_8,function(bb){bb.$==0?ba(void 0):void 0;return _9.Return($);});});})))));};}());
